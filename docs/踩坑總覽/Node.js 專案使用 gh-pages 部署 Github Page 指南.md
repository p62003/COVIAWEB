# Node.js å°ˆæ¡ˆä½¿ç”¨ gh-pages éƒ¨ç½²è£œå……æŒ‡å—

å°æ–¼ä½¿ç”¨ Reactã€Vue ç­‰ Node.js æ¡†æ¶çš„å°ˆæ¡ˆï¼Œå¯ä»¥ä½¿ç”¨ `gh-pages` å¥—ä»¶ä¾†ç°¡åŒ– GitHub Pages çš„éƒ¨ç½²æµç¨‹ã€‚é€™ç¨®æ–¹æ³•æ¯”æ‰‹å‹•è¨­å®šæ›´ç°¡å–®ä¸”å¯é ã€‚

## åˆæ¬¡è¨­å®š gh-pages

### âœ… æ­¥é©Ÿæµç¨‹

1. **å®‰è£ gh-pages å¥—ä»¶**
   
   ```bash
   # é€²å…¥å°ˆæ¡ˆè³‡æ–™å¤¾
   cd my-knowledge-docs
   
   # å®‰è£ gh-pages å¥—ä»¶ç‚ºé–‹ç™¼ä¾è³´
   npm install --save-dev gh-pages
   
   # æª¢æŸ¥æ˜¯å¦å®‰è£æˆåŠŸ
   npm list gh-pages
   # æ‡‰é¡¯ç¤ºå®‰è£çš„ gh-pages ç‰ˆæœ¬
   ```

2. **è¨­å®š package.json**
   
   ```bash
   # é–‹å•Ÿ package.json æª”æ¡ˆ
   nano package.json
   ```
   
   åœ¨ package.json ä¸­æ–°å¢ä»¥ä¸‹è¨­å®šï¼š
   
   ```json
   {
     "name": "my-knowledge-docs",
     "version": "1.0.0",
     
     // ... å…¶ä»–åŸæœ‰è¨­å®š ...
     
     "homepage": "https://ä½ çš„å¸³è™Ÿ.github.io/my-knowledge-docs",
     "scripts": {
       // ... ä¿ç•™åŸæœ‰è…³æœ¬ ...
       "predeploy": "npm run build",
       "deploy": "gh-pages -d build"
     }
   }
   ```
   
   > æ³¨æ„ï¼šå°‡ `build` æ”¹ç‚ºä½ å°ˆæ¡ˆå¯¦éš›çš„å»ºç½®è¼¸å‡ºè³‡æ–™å¤¾ï¼Œä¾‹å¦‚ï¼š
   > - React å°ˆæ¡ˆé€šå¸¸æ˜¯ `build` 
   > - Vue å°ˆæ¡ˆé€šå¸¸æ˜¯ `dist`
   > - Docusaurus å°ˆæ¡ˆé€šå¸¸æ˜¯ `build`

3. **é€²è¡Œåˆæ¬¡éƒ¨ç½²**
   
   ```bash
   # åŸ·è¡Œéƒ¨ç½²æŒ‡ä»¤
   npm run deploy
   
   # æ­¤æŒ‡ä»¤æœƒè‡ªå‹•åŸ·è¡Œä»¥ä¸‹æ­¥é©Ÿï¼š
   # 1. åŸ·è¡Œ npm run build (å› ç‚ºè¨­å®šäº† predeploy)
   # 2. å°‡å»ºç½®çµæœæ¨é€åˆ° gh-pages åˆ†æ”¯
   ```

4. **è¨­å®š GitHub Pages ä¾†æºç‚º gh-pages åˆ†æ”¯**
   
   - å‰å¾€ GitHub å°ˆæ¡ˆé é¢
   - é€²å…¥ Settings > Pages
   - åœ¨ Source å€åŸŸé¸æ“‡ `gh-pages` åˆ†æ”¯å’Œ `/ (root)` è³‡æ–™å¤¾
   - é»æ“Š Save

5. **æª¢æŸ¥éƒ¨ç½²çµæœ**
   
   ```bash
   # ç­‰å¾…ç´„ 2-5 åˆ†é˜ï¼Œç„¶å¾Œæª¢æŸ¥ç¶²ç«™æ˜¯å¦å¯è¨ªå•
   curl -I https://ä½ çš„å¸³è™Ÿ.github.io/my-knowledge-docs/
   # æ‡‰è©²é¡¯ç¤º HTTP/2 200
   ```

### ğŸ” é—œéµæª¢æŸ¥æ­¥é©Ÿ

| æª¢æŸ¥æŒ‡ä»¤ | ç”¨é€” | é æœŸçµæœ |
|---------|------|----------|
| `npm list gh-pages` | æª¢æŸ¥ gh-pages æ˜¯å¦å®‰è£ | é¡¯ç¤ºå®‰è£çš„ç‰ˆæœ¬è™Ÿ |
| `git branch -a` | æª¢æŸ¥ gh-pages åˆ†æ”¯æ˜¯å¦å­˜åœ¨ | åˆ—è¡¨ä¸­æ‡‰åŒ…å« `remotes/origin/gh-pages` |
| `curl -I https://ä½ çš„å¸³è™Ÿ.github.io/my-knowledge-docs/` | æª¢æŸ¥ç¶²ç«™æ˜¯å¦å¯è¨ªå• | HTTP/2 200 (OK) |

### âš ï¸ å¸¸è¦‹å•é¡Œèˆ‡é é˜²æ–¹æ³•

1. **ã€Œæ‰¾ä¸åˆ° npm æŒ‡ä»¤ã€**
   
   **é é˜²æ–¹æ³•**: å®‰è£ Node.js
   - å‰å¾€ https://nodejs.org/ ä¸‹è¼‰ä¸¦å®‰è£ Node.js
   - å®‰è£å¾Œé‡æ–°é–‹å•Ÿå‘½ä»¤åˆ—è¦–çª—
   - åŸ·è¡Œ `node -v` å’Œ `npm -v` ç¢ºèªå®‰è£æˆåŠŸ

2. **ã€Œéƒ¨ç½²æ™‚å‡ºç¾éŒ¯èª¤ã€**
   
   **é é˜²æ–¹æ³•**: æª¢æŸ¥å°ˆæ¡ˆè¨­å®šå’Œæ¬Šé™
   ```bash
   # ç¢ºèª git ä½¿ç”¨è€…è¨­å®šæ­£ç¢º
   git config user.name
   git config user.email
   
   # ç¢ºèªæœ‰æ­£ç¢ºçš„ GitHub æ¬Šé™
   git push origin main --dry-run
   
   # æ¸…é™¤ gh-pages å¿«å–
   rm -rf node_modules/.cache/gh-pages
   ```

3. **ã€Œéƒ¨ç½²å¾Œç¶²ç«™é¡¯ç¤º 404ã€**
   
   **é é˜²æ–¹æ³•**: ç¢ºèª homepage è¨­å®šå’Œåˆ†æ”¯é¸æ“‡
   ```bash
   # æª¢æŸ¥ package.json ä¸­çš„ homepage è¨­å®š
   grep "homepage" package.json
   
   # ç¢ºèª GitHub Pages è¨­å®šä½¿ç”¨ gh-pages åˆ†æ”¯
   # (éœ€è¦åœ¨ GitHub ç¶²é ä¸Šæª¢æŸ¥)
   
   # å¼·åˆ¶é‡æ–°éƒ¨ç½²
   npm run deploy
   ```

## å¾ŒçºŒæ›´æ–° GitHub Pages (ä½¿ç”¨ gh-pages)

### âœ… ç°¡åŒ–æµç¨‹

ä½¿ç”¨ gh-pages å¥—ä»¶å¾Œï¼Œéƒ¨ç½²æµç¨‹å¤§å¹…ç°¡åŒ–ï¼š

```bash
# æ­¥é©Ÿ 1ï¼šç¢ºä¿æœ¬åœ°ä»£ç¢¼æ˜¯æœ€æ–°çš„
git pull origin main

# æ­¥é©Ÿ 2ï¼šé€²è¡Œä¿®æ”¹
# (ä¿®æ”¹ä½ çš„æª”æ¡ˆ...)

# æ­¥é©Ÿ 3ï¼šæäº¤ä¿®æ”¹åˆ° main åˆ†æ”¯
git add .
git commit -m "æ›´æ–°ç¶²ç«™å…§å®¹"
git push origin main

# æ­¥é©Ÿ 4ï¼šä¸€éµéƒ¨ç½²åˆ° GitHub Pages
npm run deploy
```

### ğŸ” éƒ¨ç½²éç¨‹è©³è§£

åŸ·è¡Œ `npm run deploy` æ™‚ï¼Œä»¥ä¸‹æ­¥é©Ÿæœƒè‡ªå‹•å®Œæˆï¼š

1. åŸ·è¡Œ `npm run build` (å› ç‚ºè¨­å®šäº† predeploy)
2. å»ºç«‹ä¸€å€‹è‡¨æ™‚è³‡æ–™å¤¾
3. åˆå§‹åŒ–ä¸€å€‹ git å€‰åº«åœ¨è‡¨æ™‚è³‡æ–™å¤¾ä¸­
4. å°‡å»ºç½®è¼¸å‡ºè³‡æ–™å¤¾çš„å…§å®¹è¤‡è£½åˆ°è‡¨æ™‚è³‡æ–™å¤¾
5. å»ºç«‹ä¸€å€‹æäº¤
6. å°‡é€™å€‹æäº¤æ¨é€åˆ° GitHub å°ˆæ¡ˆçš„ gh-pages åˆ†æ”¯
7. åˆªé™¤è‡¨æ™‚è³‡æ–™å¤¾

é€™å€‹éç¨‹ç”± gh-pages å¥—ä»¶è‡ªå‹•è™•ç†ï¼Œç„¡éœ€æ‰‹å‹•ä»‹å…¥ã€‚

åœ¨ã€Œåˆæ¬¡è¨­å®š gh-pagesã€çš„ç¬¬ 2 æ­¥ã€Œè¨­å®š package.jsonã€ä¸­ï¼Œå¯¦éš›ä¸Šå·²ç¶“åŒ…å«äº† predeploy çš„è¨­å®šï¼Œä½†æ²’æœ‰ç‰¹åˆ¥å¼·èª¿æˆ–è§£é‡‹å®ƒçš„ä½œç”¨ã€‚
å…·é«”ä¾†èªªï¼Œåœ¨é‚£å€‹ JSON ç‰‡æ®µä¸­æœ‰é€™å…©è¡Œï¼š
```
"predeploy": "npm run build",
"deploy": "gh-pages -d build"
```
é—œæ–¼ predeploy: é€™æ˜¯ npm çš„ç‰¹æ®Šè…³æœ¬åç¨±ï¼Œç•¶åŸ·è¡Œ npm run deploy æ™‚ï¼Œnpm æœƒè‡ªå‹•å…ˆåŸ·è¡Œ predeploy è…³æœ¬ï¼Œå†åŸ·è¡Œ deploy è…³æœ¬ã€‚é€™æ¨£è¨­è¨ˆå¯ä»¥ç¢ºä¿æ¯æ¬¡éƒ¨ç½²å‰éƒ½å…ˆé€²è¡Œæœ€æ–°çš„å»ºç½®ï¼Œé¿å…éƒ¨ç½²èˆŠçš„å…§å®¹ã€‚

### âš ï¸ æ³¨æ„äº‹é …

1. **å¿…é ˆå…ˆæäº¤ç¨‹å¼ç¢¼åˆ° main åˆ†æ”¯**
   - ç¢ºä¿å…ˆ `git push origin main` å† `npm run deploy`
   - é€™æ¨£å¯ä»¥ä¿æŒæºç¢¼å’Œéƒ¨ç½²å…§å®¹åŒæ­¥

2. **è‡ªè¨‚éƒ¨ç½²è¨Šæ¯**
   ```bash
   npm run deploy -- -m "è‡ªè¨‚éƒ¨ç½²è¨Šæ¯ [è·³é CI]"
   ```

3. **éƒ¨ç½²ç‰¹å®šè³‡æ–™å¤¾**
   - å¦‚æœå»ºç½®è¼¸å‡ºä¸æ˜¯ `build` è³‡æ–™å¤¾ï¼Œè«‹ä¿®æ”¹ package.jsonï¼š
   ```json
   "deploy": "gh-pages -d ä½ çš„è¼¸å‡ºè³‡æ–™å¤¾åç¨±"
   ```

## æœ€ä½³å¯¦è¸

### ğŸ“ å·¥ä½œæµç¨‹

1. **é–‹ç™¼-æäº¤-éƒ¨ç½²åˆ†é›¢**
   ```bash
   # 1. é–‹ç™¼ä¸¦æ¸¬è©¦
   npm start  # æˆ– npm run dev ç­‰é–‹ç™¼æŒ‡ä»¤
   
   # 2. æäº¤ç¨‹å¼ç¢¼
   git add .
   git commit -m "æ›´æ–°å…§å®¹"
   git push origin main
   
   # 3. éƒ¨ç½²ç¶²ç«™
   npm run deploy
   ```

2. **ä½¿ç”¨æŒçºŒé›†æˆ (é€²éšç”¨æˆ¶)**
   - è¨­å®š GitHub Actions åœ¨æ¨é€åˆ° main åˆ†æ”¯æ™‚è‡ªå‹•éƒ¨ç½²
   - å»ºç«‹ `.github/workflows/deploy.yml` æª”æ¡ˆ

### ğŸ“‹ å•é¡Œæ’è§£å‚™å¿˜éŒ„

| å•é¡Œ | è§£æ±ºæ–¹æ³• |
|------|----------|
| éƒ¨ç½²å¾Œç¶²ç«™æœªæ›´æ–° | ç­‰å¾…ç´„ 5 åˆ†é˜ï¼Œæª¢æŸ¥ gh-pages åˆ†æ”¯æ˜¯å¦æ›´æ–° |
| éƒ¨ç½²æŒ‡ä»¤å¤±æ•— | åˆªé™¤ `node_modules/.cache/gh-pages`ï¼Œé‡æ–°åŸ·è¡Œ |
| è³‡æºè·¯å¾‘éŒ¯èª¤ | ç¢ºèª package.json ä¸­ homepage è¨­å®šæ­£ç¢º |
| è‡ªè¨‚åŸŸåæ¶ˆå¤± | æª¢æŸ¥æ˜¯å¦åœ¨æ¯æ¬¡éƒ¨ç½²éƒ½æœƒè¦†è“‹ CNAME æª”æ¡ˆ |

---

## ğŸŒŸ å°çµ

ä½¿ç”¨ gh-pages å¥—ä»¶å¾Œï¼ŒGitHub Pages çš„éƒ¨ç½²æµç¨‹è®Šå¾—æ¥µç‚ºç°¡å–®ï¼š

1. **åˆæ¬¡è¨­å®š**ï¼šå®‰è£å¥—ä»¶ï¼Œè¨­å®š package.jsonï¼ŒåŸ·è¡Œåˆæ¬¡éƒ¨ç½²
2. **æ—¥å¸¸æ›´æ–°**ï¼šä¿®æ”¹å…§å®¹ï¼Œæäº¤åˆ° mainï¼ŒåŸ·è¡Œ `npm run deploy`

é€™ç¨®æ–¹æ³•è‡ªå‹•è™•ç†åˆ†æ”¯ç®¡ç†å’Œæª”æ¡ˆè¤‡è£½ï¼Œè®“ä½ å°ˆæ³¨æ–¼å…§å®¹å‰µä½œè€Œééƒ¨ç½²ç´°ç¯€ã€‚å°æ–¼å¤§å¤šæ•¸ Node.js æ¡†æ¶çš„å°ˆæ¡ˆï¼Œé€™æ˜¯æœ€æ¨è–¦çš„ GitHub Pages éƒ¨ç½²æ–¹å¼ã€‚